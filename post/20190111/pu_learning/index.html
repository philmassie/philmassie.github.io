<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>PU Learning</title>
  <meta property="og:title" content="PU Learning" />
  <meta name="twitter:title" content="PU Learning" />
  <meta name="description" content="Introduction Disclaimer. not intended to be exhaustive and complete. Really just my notes but may be helpful to others. this post is based on this Fusilier et al. 2014 /cite Outline the problem in general.
previously I have used the approach, in a highly imbalanced dagta set, of randomly sampling from the unkowns and treating these as negatives. I freely admit that this is not exactly ideal, but out in the wild, with real-life deadlines, the approach &ldquo;wasn&rsquo;t the worst&rdquo;.">
  <meta property="og:description" content="Introduction Disclaimer. not intended to be exhaustive and complete. Really just my notes but may be helpful to others. this post is based on this Fusilier et al. 2014 /cite Outline the problem in general.
previously I have used the approach, in a highly imbalanced dagta set, of randomly sampling from the unkowns and treating these as negatives. I freely admit that this is not exactly ideal, but out in the wild, with real-life deadlines, the approach &ldquo;wasn&rsquo;t the worst&rdquo;.">
  <meta name="twitter:description" content="Introduction Disclaimer. not intended to be exhaustive and complete. Really just my notes but may be helpful to others. this post is based on this Fusilier et al. 2014 /cite Outline the problem in …">
  <meta name="author" content="Philip Massie"/>
  <link href='https://philmassie.github.io/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://philmassie.github.io/img/mug.png" />
  <meta name="twitter:image" content="https://philmassie.github.io/img/mug.png" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="https://philmassie.github.io/post/20190111/pu_learning/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="kabelsalat" />

  <meta name="generator" content="Hugo 0.53" />
  <link rel="canonical" href="https://philmassie.github.io/post/20190111/pu_learning/" />
  <link rel="alternate" href="" type="application/rss+xml" title="kabelsalat">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://philmassie.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="https://philmassie.github.io/css/highlighting.css" />
  <link rel="stylesheet" href="https://philmassie.github.io/css/pygment_highlights.css" />
  <link rel="stylesheet" href="https://philmassie.github.io/css/highlight.min.css" />


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-24074009-12', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://philmassie.github.io/">kabelsalat</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        
          
            <li>
              <a title="About" href="/page/about/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="kabelsalat" href="https://philmassie.github.io/">
            <img class="avatar-img" src="https://philmassie.github.io/img/mug.png" alt="kabelsalat" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="post-heading">
              <h1>PU Learning</h1>
                
                
                  <span class="post-meta">
  <i class="fa fa-calendar-o"></i>&nbsp;Posted on January 11, 2019
  &nbsp;|&nbsp; <i class="fa fa-clock-o"></i> 6 min (1075 mots)
  
</span>


                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        

<h2 id="introduction">Introduction</h2>

<p>Disclaimer. not intended to be exhaustive and complete. Really just my notes but may be helpful to others. this post is based on this Fusilier et al. 2014 /cite
Outline the problem in general.</p>

<p>previously I have used the approach, in a highly imbalanced dagta set, of randomly sampling from the unkowns and treating these as negatives. I freely admit that this is not exactly ideal, but out in the wild, with real-life deadlines, the approach &ldquo;wasn&rsquo;t the worst&rdquo;. This challenge kwwps cropping up int the data sets I typicqlly work with and in the questions I am often persuing. So I was recently ble to take a few moments to read around the topic a little and it seemed like it might be worth keeping a few notes:</p>

<p>There are a few different PU approaches around.
Most widely cited initial attempts come from Liu et al. 2002 and 2003 but I’m not absolutely sure if they were the first to try and isolate an approach to the problem.
Interesting diffs between the two are that while Liu et al/&rsquo;s approach iteratively increases the size of the negative class from the unknowns, Fusilier et al.s approach iteratively reduces and refines it. That means that it may prove useful for highly imbalanced class problems and the authors do point this out.</p>

<p>Other PU approaches involving imbalanced data often involve some sort of random sampling or bagging approach, but Fusilier et al.&rsquo;s approach rely on the classifier itself to isolate so called reliable negatives (RN) from the unknown data set.</p>

<p>One such sapling approach to PU learnign involves bagging. Basically, random bootstrap samples are drawn from the unknown set, and classifiers are trained to distinguish between the positive samples and the various bootstrap unknown sets. each random set should have dfferent degrees of contamination by unlabled positives and .. <strong>flesh this out a bit</strong></p>

<h2 id="methods">Methods</h2>

<h3 id="original-approach-liu-et-al-2002-and-2003">&lsquo;Original&rsquo; approach (Liu et al. 2002 and 2003)</h3>

<p>Given a training set containing only positives (P) and unknown (U) classes follow the following steps:</p>

<ol>
<li>Treating all U as negatives (N) train a classifier P vs. U</li>
<li>Using the classifier, score the unknown class and isolate the set of &lsquo;reliable&rsquo; negatives (RN).</li>
<li>Train a new classifier on P vs. RN, use it to score the remaining U and isolate additional RN.</li>
<li>Repeat step 3, iteratively enlarging the set of RN until the stopping condition is met.</li>
</ol>

<p>The stopping condition is met when no new negative cases are classified.</p>

<p>Where <code>Q</code> is defined as the set of unknowns classified as negatives and <code>i</code> is the iterator, the stopping condition is defined as:</p>

<p><code>|Qi| &gt; 0</code></p>

<h3 id="modified-approach-fusilier-et-al-2014">Modified approach (Fusilier et al. 2014)</h3>

<p>Given a training set containing only positives (P) and unknown (U) classes follow the following steps:</p>

<ol>
<li>Treating all U as negatives (N) train a classifier P vs. U</li>
<li>Using the classifier, score the unknown class and isolate the set of &lsquo;reliable&rsquo; negatives (RN).</li>
<li>Train a new classifier on P vs. RN. Score RN and exclude predicted positives from RN</li>
<li>Repeat step 3, iteratively refining the RN set, until the stopping condition is met.</li>
</ol>

<p>The stopping condition ensures that Q reduces in size (avoiding sudden large reductions in RN size) while the RN set never gets smaller than the P set. More explicitly:</p>

<blockquote>
<p>while the size of the set of unknowns classified as negatives in <em>this iteration</em> is smaller than or equal to the size of the set of unknowns classified as negatives in <em>the previous iteration</em> and the size of the set of positive classes  is smaller than the set of refined RNs resulting from <em>this iteration</em></p>
</blockquote>

<p>Where <code>Q</code> is defined as the set of unknowns classified as negatives and <code>i</code> is the iterator, the stopping condition is defined as:</p>

<p><code>|Qi| &lt;= |Q(i-1)| &amp; |P| &lt; |RNi|</code></p>

<blockquote>
<h4 id="things-to-follow-up-on">Things to follow up on:</h4>

<ol>
<li>Most of the articles use SVM, but they also tend to be NLP problems. Does the classifier family matter much?</li>
<li>How does the original paper identify the cut-off for determining &lsquo;reliability&rsquo;</li>
<li>Modified approach: Why could Q get larger with the iterations?</li>
<li>Bagging approach: Consider how best to penalise false negatives.

<ul>
<li>Cutoff selection?</li>
</ul></li>
</ol>
</blockquote>

<h3 id="bagging-approach-inductive-mordelet-vert-2013">Bagging approach (Inductive) (Mordelet &amp; Vert 2013)</h3>

<p>Given a training set containing only positives (P) and unknowns (U), where K = size of bootstrap samples and T = number of samples, follow the following steps:</p>

<ol>
<li>Draw a bootstrap sample Ut of size K from U</li>
<li>Train a classifier P vs Ut</li>
<li>Repeat steps 1 and 2 T times</li>
<li>Score the test data with an ensemble approach using the bagged models.</li>
</ol>

<p>The stopping criterion here is determined by the value of T and the authors suggest that there is typically not much additional value to be gained by setting T &gt; 100. Judging from their plots however, where <code>|P|</code> and <code>K</code> are both large large, there is little change above T = 5. I suspect it&rsquo;s worth trying to keep track of this during training if possible or setting up an early stopping type criterion in your function because depending on your time constraints, training 100 models may not be viable.</p>

<h2 id="conclusion">Conclusion</h2>

<p>These three methods provide sensible approaches to the problem of PU learning but only the modified and bagging approaches provide inherent ways to deal with imbalanced data. My plan is to try and implement these 2 approaches and compare their results. While I cant share the data publicly, I will try and share the code and general results on the blog and in GitHub. We work primarily in Python/PySpark or Scala/Spark. Since we don&rsquo;t have friendly interactive environments at work for Scala I tend to do EDA and testing in PySpark before moving everything over to Scala. If you have nice Scala/Spark environments set up check out</p>

<ul>
<li><a href="https://github.com/ispras/pu4spark">https://github.com/ispras/pu4spark</a> PU learning libraries written in Spark</li>
<li><a href="https://astrakhantsev.com/pu-learning/">https://astrakhantsev.com/pu-learning/</a> nice post written by author of pu4spark</li>
<li><a href="https://roywright.me/2017/11/16/positive-unlabeled-learning/">https://roywright.me/2017/11/16/positive-unlabeled-learning/</a> Nice overview of PU learning approaches</li>
</ul>

<h2 id="references">References</h2>

<p>Fusilier DH, Montes-y-Gómez M, Rosso P, Guzmán Cabrera R (2015) Detecting positive and negative deceptive opinions using PU-learning. Inf Process Manag 51:433–443. doi: 10.1016/j.ipm.2014.11.001</p>

<p>Liu B, Dai Y, Li X, et al (2003) Building text classifiers using positive and unlabeled examples. In: Third IEEE International Conference on Data Mining. pp 179–186</p>

<p>Liu B, Lee WS, Yu PS, Li X (2002) Partially Supervised Classification of Text Documents. In: Proc. 19th Intl. Conf. on Machine Learning. pp 387–394</p>

<p>Mordelet F, Vert J-P (2014) A bagging SVM to learn from positive and unlabeled examples. Pattern Recognit Lett 37:201–209. doi: 10.1016/j.patrec.2013.06.010</p>

      </article>

      <ul class="pager blog-pager">
        
          <li class="previous">
            <a href="https://philmassie.github.io/post/20160804/r_netcdf_cheatsheet/" data-toggle="tooltip" data-placement="top" title="R Netcdf cheatsheet">&larr; Previous Post</a>
          </li>
        
        
      </ul>


      
        
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:philmassie@webafrica.org.za" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/philmassie" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://linkedin.com/in/philmassie" title="LinkedIn">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://www.instagram.com/philmassie" title="Instagram">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="philmassie.github.io">Philip Massie</a>
            
          

          &nbsp;&bull;&nbsp;
          2019

          
            &nbsp;&bull;&nbsp;
            <a href="https://philmassie.github.io/">kabelsalat</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.53</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://philmassie.github.io/js/main.js"></script>
<script src="https://philmassie.github.io/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js" integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js" integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin="anonymous"></script>
<script src="https://philmassie.github.io/js/load-photoswipe.js"></script>



  </body>
</html>

